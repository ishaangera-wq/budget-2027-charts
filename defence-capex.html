<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Defence Capex</title>
<style>
  :root {
    --bg: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --grid: rgba(0,0,0,0.08);
    --series: #1f5aa6;
    --highlight: #d7191c;
  }
  body {
    margin: 0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
  }
  .wrap {
    max-width: 900px;
    margin: 0 auto;
    padding: 16px 16px 10px 16px;
  }
  h1 {
    font-size: 22px;
    margin: 0 0 4px 0;
    line-height: 1.2;
  }
  .sub {
    color: var(--muted);
    font-size: 14px;
    margin: 0 0 10px 0;
  }
  .note {
    color: var(--muted);
    font-size: 12px;
    margin-top: 8px;
  }
  .chart {
    position: relative;
    height: 420px;
  }
  @media (max-width: 520px) {
    .chart { height: 360px; }
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
</head>
<body>
  <div class="wrap">
    <h1>Defence Capex</h1>
    <p class="sub">â‚¹ crore</p>
    <div class="chart">
      <canvas id="c"></canvas>
    </div>
    <div class="note">Source: Union Budget</div>
  </div>

<script>
(() => {
  const labels = ["FY17", "FY18", "FY19", "FY20", "FY21", "FY22", "FY23", "FY24", "FY25", "FY26RE", "FY27BE"];
  const values = [86356.9, 90438.4, 95230.6, 111092.4, 134304.9, 137987.0, 142940.0, 157228.2, 159768.4, 186454.2, 219306.5];
  const highlightIndex = 10;

  const isBar = "bar" === "bar";

  const colors = labels.map((_, i) => i === highlightIndex ? getComputedStyle(document.documentElement).getPropertyValue('--highlight').trim()
                                                         : getComputedStyle(document.documentElement).getPropertyValue('--series').trim());

  const ctx = document.getElementById('c');

  Chart.register(ChartDataLabels);

  const fmtNumber = (v) => {
    // Indian-style grouping isn't native without Intl in all cases; use Intl if available.
    try {
      return new Intl.NumberFormat('en-IN', { maximumFractionDigits: (Math.abs(v) < 100 ? 2 : 0) }).format(v);
    } catch (e) {
      return String(v);
    }
  };

  new Chart(ctx, {
    type: isBar ? 'bar' : 'line',
    data: {
      labels,
      datasets: [{
        label: "Defence Capex",
        data: values,
        borderColor: getComputedStyle(document.documentElement).getPropertyValue('--series').trim(),
        backgroundColor: isBar ? colors : 'transparent',
        pointBackgroundColor: (context) => {
          const i = context.dataIndex;
          return i === highlightIndex ? getComputedStyle(document.documentElement).getPropertyValue('--highlight').trim()
                                      : getComputedStyle(document.documentElement).getPropertyValue('--series').trim();
        },
        pointRadius: isBar ? 0 : 4,
        pointHoverRadius: isBar ? 0 : 5,
        borderWidth: isBar ? 0 : 3,
        tension: 0.25
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: (ctx) => fmtNumber(ctx.parsed.y)
          }
        },
        datalabels: {
          anchor: isBar ? 'end' : 'end',
          align: isBar ? 'end' : 'top',
          clamp: true,
          color: (ctx) => {
            const i = ctx.dataIndex;
            return i === highlightIndex ? getComputedStyle(document.documentElement).getPropertyValue('--highlight').trim()
                                        : getComputedStyle(document.documentElement).getPropertyValue('--series').trim();
          },
          font: { weight: '700', size: 12 },
          formatter: (v) => fmtNumber(v)
        }
      },
      scales: {
        x: {
          grid: { display: false },
          ticks: { color: '#374151', maxRotation: 0, autoSkip: true }
        },
        y: {
          grid: { color: getComputedStyle(document.documentElement).getPropertyValue('--grid').trim() },
          ticks: {
            color: '#374151',
            callback: (v) => fmtNumber(v)
          }
        }
      }
    }
  });
})();
</script>
</body>
</html>
